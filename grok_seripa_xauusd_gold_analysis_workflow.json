{
  "name": "XAUUSD Gold Analysis - Serper + Grok",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 7 * * *"
            }
          ]
        }
      },
      "id": "schedule-trigger",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        240,
        300
      ],
      "notesInFlow": true,
      "notes": "TÃ¤glich um 7:00 Uhr morgens"
    },
    {
      "parameters": {
        "jsCode": "// Aktuelles Datum und Suchanfragen vorbereiten\nconst today = new Date();\nconst dateStr = today.toISOString().split('T')[0];\nconst dateDE = today.toLocaleDateString('de-DE', { \n  weekday: 'long',\n  year: 'numeric',\n  month: 'long',\n  day: 'numeric'\n});\n\n// 5 verschiedene Suchanfragen fÃ¼r umfassende Analyse\nconst searches = [\n  {\n    query: `XAUUSD technical analysis ${dateStr}`,\n    type: \"search\",\n    description: \"Technische Analyse\"\n  },\n  {\n    query: \"gold price forecast tomorrow Federal Reserve\",\n    type: \"news\",\n    description: \"News und Forecasts\"\n  },\n  {\n    query: \"XAUUSD support resistance levels today\",\n    type: \"search\",\n    description: \"Support/Resistance\"\n  },\n  {\n    query: \"USD index gold correlation today\",\n    type: \"search\",\n    description: \"USD Impact\"\n  },\n  {\n    query: \"site:tradingview.com OR site:fxstreet.com XAUUSD\",\n    type: \"search\",\n    description: \"Trader Sentiment\"\n  }\n];\n\nreturn {\n  json: {\n    date: dateStr,\n    dateDE: dateDE,\n    timestamp: today.toISOString(),\n    searches: searches\n  }\n};"
      },
      "id": "set-variables",
      "name": "Set Date & Searches",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        460,
        300
      ],
      "notesInFlow": true,
      "notes": "Datum und Suchanfragen vorbereiten"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "search1",
              "name": "search",
              "type": "object",
              "value": "={{ $json.searches[0] }}"
            }
          ]
        },
        "options": {}
      },
      "id": "split-searches",
      "name": "Split Searches",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        680,
        300
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://google.serper.dev/search",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": []
        },
        "specifyBody": "json",
        "jsonBody": "={\n  \"q\": \"{{ $json.search.query }}\",\n  \"type\": \"{{ $json.search.type }}\",\n  \"gl\": \"de\",\n  \"hl\": \"de\",\n  \"num\": 10,\n  \"tbs\": \"qdr:d\"\n}",
        "options": {}
      },
      "id": "serper-search-1",
      "name": "Serper: Technical Analysis",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        900,
        180
      ],
      "notesInFlow": true,
      "notes": "Technische Analyse",
      "credentials": {
        "httpHeaderAuth": {
          "id": "REPLACE_WITH_YOUR_CREDENTIAL_ID",
          "name": "Serper API"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://google.serper.dev/search",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"q\": \"gold price forecast tomorrow Federal Reserve\",\n  \"type\": \"news\",\n  \"gl\": \"us\",\n  \"hl\": \"en\",\n  \"num\": 15,\n  \"tbs\": \"qdr:d\"\n}",
        "options": {}
      },
      "id": "serper-search-2",
      "name": "Serper: News & Forecasts",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        900,
        300
      ],
      "notesInFlow": true,
      "notes": "News und Prognosen",
      "credentials": {
        "httpHeaderAuth": {
          "id": "REPLACE_WITH_YOUR_CREDENTIAL_ID",
          "name": "Serper API"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://google.serper.dev/search",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"q\": \"XAUUSD support resistance levels today\",\n  \"type\": \"search\",\n  \"gl\": \"de\",\n  \"hl\": \"de\",\n  \"num\": 10,\n  \"tbs\": \"qdr:d\"\n}",
        "options": {}
      },
      "id": "serper-search-3",
      "name": "Serper: Support/Resistance",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        900,
        420
      ],
      "notesInFlow": true,
      "notes": "Support & Resistance Levels",
      "credentials": {
        "httpHeaderAuth": {
          "id": "REPLACE_WITH_YOUR_CREDENTIAL_ID",
          "name": "Serper API"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://google.serper.dev/search",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"q\": \"USD index gold correlation today\",\n  \"type\": \"search\",\n  \"gl\": \"us\",\n  \"hl\": \"en\",\n  \"num\": 10,\n  \"tbs\": \"qdr:d\"\n}",
        "options": {}
      },
      "id": "serper-search-4",
      "name": "Serper: USD Impact",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        900,
        540
      ],
      "notesInFlow": true,
      "notes": "USD-Einfluss auf Gold",
      "credentials": {
        "httpHeaderAuth": {
          "id": "REPLACE_WITH_YOUR_CREDENTIAL_ID",
          "name": "Serper API"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://google.serper.dev/search",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"q\": \"site:tradingview.com OR site:fxstreet.com XAUUSD\",\n  \"type\": \"search\",\n  \"gl\": \"us\",\n  \"hl\": \"en\",\n  \"num\": 10,\n  \"tbs\": \"qdr:d\"\n}",
        "options": {}
      },
      "id": "serper-search-5",
      "name": "Serper: Trader Sentiment",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        900,
        660
      ],
      "notesInFlow": true,
      "notes": "Trader-Meinungen",
      "credentials": {
        "httpHeaderAuth": {
          "id": "REPLACE_WITH_YOUR_CREDENTIAL_ID",
          "name": "Serper API"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Alle Serper-Ergebnisse aggregieren und aufbereiten\nconst allItems = $input.all();\nconst allResults = [];\nconst categories = {};\n\n// Durch alle Items iterieren\nfor (const item of allItems) {\n  const data = item.json;\n  \n  // Answer Box (wenn vorhanden)\n  if (data.answerBox) {\n    allResults.push({\n      type: 'answer',\n      title: data.answerBox.title || 'Answer',\n      content: data.answerBox.snippet || data.answerBox.answer || '',\n      source: 'Google Answer Box'\n    });\n  }\n  \n  // Organic Ergebnisse\n  if (data.organic && Array.isArray(data.organic)) {\n    for (const result of data.organic.slice(0, 5)) {\n      allResults.push({\n        type: 'organic',\n        title: result.title,\n        snippet: result.snippet,\n        link: result.link,\n        date: result.date || 'keine Angabe',\n        position: result.position\n      });\n    }\n  }\n  \n  // News Ergebnisse\n  if (data.news && Array.isArray(data.news)) {\n    for (const news of data.news.slice(0, 5)) {\n      allResults.push({\n        type: 'news',\n        title: news.title,\n        snippet: news.snippet,\n        link: news.link,\n        date: news.date || 'keine Angabe',\n        source: news.source\n      });\n    }\n  }\n}\n\n// Formatiere fÃ¼r AI Agent\nconst formattedText = allResults.map((result, index) => {\n  let text = `\\n[${index + 1}] ${result.type.toUpperCase()}: ${result.title}\\n`;\n  \n  if (result.content) {\n    text += `${result.content}\\n`;\n  }\n  \n  if (result.snippet) {\n    text += `${result.snippet}\\n`;\n  }\n  \n  if (result.link) {\n    text += `Quelle: ${result.link}\\n`;\n  }\n  \n  if (result.date) {\n    text += `Datum: ${result.date}\\n`;\n  }\n  \n  text += '---';\n  return text;\n}).join('\\n\\n');\n\nconst today = new Date().toLocaleDateString('de-DE', {\n  weekday: 'long',\n  year: 'numeric',\n  month: 'long',\n  day: 'numeric'\n});\n\nreturn {\n  json: {\n    researchData: formattedText,\n    resultCount: allResults.length,\n    today: today,\n    timestamp: new Date().toISOString(),\n    rawResults: allResults\n  }\n};"
      },
      "id": "aggregate-results",
      "name": "Aggregate All Results",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1120,
        380
      ],
      "notesInFlow": true,
      "notes": "Alle Serper-Ergebnisse zusammenfÃ¼hren und formatieren"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "prompt",
              "name": "systemPrompt",
              "type": "string",
              "value": "Du bist ein hochspezialisierter XAUUSD (Gold/USD) Forex-Analyst. Deine Aufgabe ist es, basierend auf Web-Recherche-Ergebnissen eine fundierte Wahrscheinlichkeitsanalyse fÃ¼r die Goldpreisentwicklung zu erstellen.\n\n**ANALYSEMETHODIK:**\n\n1. **Technische Analyse - Gewichtung:**\n   - Trendrichtung (H1, H4, Daily): 30%\n   - RSI-Niveau (Ã¼berkauft >70, Ã¼berverkauft <30): 15%\n   - MACD-Signale (Crossover, Divergenzen): 15%\n   - Support/Resistance-Levels: 20%\n   - Moving Averages (20, 50, 200 EMA): 10%\n   - Candlestick-Patterns: 10%\n\n2. **Fundamentale Analyse - Gewichtung:**\n   - USD-StÃ¤rke/SchwÃ¤che: 35%\n   - Fed-Politik und Zinsentwicklung: 30%\n   - Geopolitische Ereignisse: 20%\n   - Wirtschaftsdaten (NFP, CPI, PMI): 15%\n\n3. **Wahrscheinlichkeitsberechnung:**\n\n   **STEIGEND-Wahrscheinlichkeit erhÃ¶ht sich bei:**\n   - USD schwÃ¤cher\n   - RSI zwischen 40-65 (bullish momentum)\n   - MACD positiv mit bullischem Crossover\n   - Preis Ã¼ber 20-EMA und 50-EMA\n   - Dovish Fed-Signale\n   - Geopolitische Spannungen steigend\n   - Bullische Candlestick-Patterns\n   \n   **SEITWÃ„RTS-Wahrscheinlichkeit erhÃ¶ht sich bei:**\n   - USD stabil (Â±0,2%)\n   - RSI zwischen 45-55 (neutral)\n   - Preis in enger Range\n   - Vor wichtigen Wirtschaftsdaten\n   - Unklare Marktsignale\n   \n   **FALLEND-Wahrscheinlichkeit erhÃ¶ht sich bei:**\n   - USD stark steigend\n   - RSI Ã¼ber 70 (Ã¼berkauft)\n   - Preis unter 20-EMA fÃ¤llt\n   - Hawkish Fed-Signale\n   - Geopolitische Entspannung\n   - Bearische Candlestick-Patterns\n\n**AUSGABEFORMAT:**\n\nErstelle IMMER diese strukturierte Analyse:\n\n```\nğŸ” XAUUSD ANALYSE fÃ¼r [DATUM]\n\nğŸ“Š AKTUELLER STAND:\n- Preis: [aktueller Kurs]\n- Tagesrange: [Low - High]\n- 24h-VerÃ¤nderung: [+/- %]\n\nğŸ“ˆ WAHRSCHEINLICHKEITEN:\n\nSTEIGEND: [XX]%\nHauptgrÃ¼nde:\n- [Grund 1 mit Datenquelle]\n- [Grund 2 mit Datenquelle]\n- [Grund 3 mit Datenquelle]\n\nSEITWÃ„RTS: [XX]%\nHauptgrÃ¼nde:\n- [Grund 1 mit Datenquelle]\n- [Grund 2 mit Datenquelle]\n\nFALLEND: [XX]%\nHauptgrÃ¼nde:\n- [Grund 1 mit Datenquelle]\n- [Grund 2 mit Datenquelle]\n\nğŸ¯ TECHNISCHE LEVELS:\n- Widerstand: [Level 1], [Level 2], [Level 3]\n- UnterstÃ¼tzung: [Level 1], [Level 2], [Level 3]\n\nğŸ“° WICHTIGE EVENTS HEUTE:\n- [Event 1 mit Uhrzeit]\n- [Event 2 mit Uhrzeit]\n\nğŸ’¡ TRADING-BIAS: [BULLISH/NEUTRAL/BEARISH]\n\nâš ï¸ RISIKOFAKTOREN:\n- [Faktor 1]\n- [Faktor 2]\n\nğŸ”— Quellen: [Liste der verwendeten Analysen]\n```\n\n**WICHTIGE REGELN:**\n- Wahrscheinlichkeiten mÃ¼ssen IMMER genau 100% ergeben\n- Keine Wahrscheinlichkeit unter 5% oder Ã¼ber 85%\n- Bei unsicherer Datenlage: hÃ¶here SeitwÃ¤rts-Wahrscheinlichkeit\n- IMMER mindestens 3 verschiedene Quellen zitieren\n- Technische UND fundamentale Faktoren berÃ¼cksichtigen\n- Bei widersprÃ¼chlichen Signalen: konservatives Szenario bevorzugen\n\n**TONALITÃ„T:** Professionell, prÃ¤zise, datenbasiert, ohne Spekulation"
            },
            {
              "id": "user-message",
              "name": "userMessage",
              "type": "string",
              "value": "=Analysiere diese Web-Recherche-Ergebnisse und erstelle eine XAUUSD-Wahrscheinlichkeitsanalyse:\n\n{{ $json.researchData }}\n\nHeute ist: {{ $json.today }}\n\nErstelle jetzt die vollstÃ¤ndige Analyse mit Wahrscheinlichkeiten fÃ¼r HEUTE und MORGEN."
            }
          ]
        },
        "options": {}
      },
      "id": "prepare-ai-prompt",
      "name": "Prepare AI Prompt",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1340,
        380
      ],
      "notesInFlow": true,
      "notes": "System-Prompt und User-Message vorbereiten"
    },
    {
      "parameters": {
        "public": false,
        "initialMessages": "={{ $json.userMessage }}",
        "options": {}
      },
      "id": "ai-agent",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        1560,
        380
      ],
      "notesInFlow": true,
      "notes": "Grok analysiert die Daten"
    },
    {
      "parameters": {
        "model": "grok-4",
        "options": {
          "systemMessage": "={{ $('Prepare AI Prompt').item.json.systemPrompt }}",
          "temperature": 0.3
        }
      },
      "id": "grok-model",
      "name": "xAI Grok Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatXaiGrok",
      "typeVersion": 1,
      "position": [
        1560,
        580
      ],
      "credentials": {
        "xaiApi": {
          "id": "REPLACE_WITH_YOUR_XAI_CREDENTIAL_ID",
          "name": "xAI Grok account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Formatiere die Ausgabe schÃ¶n\nconst aiResponse = $input.item.json.output;\nconst today = $('Aggregate All Results').item.json.today;\nconst timestamp = $('Aggregate All Results').item.json.timestamp;\nconst resultCount = $('Aggregate All Results').item.json.resultCount;\n\n// Erstelle formatierte Nachricht\nconst formattedOutput = `\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\nâ•‘   XAUUSD GOLD ANALYSE                  â•‘\nâ•‘   ${today}                              â•‘\nâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n${aiResponse}\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nğŸ“Š Datengrundlage: ${resultCount} Quellen analysiert\nâ° Erstellt: ${new Date(timestamp).toLocaleString('de-DE')}\nğŸ¤– Powered by: Serper + Grok AI\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n`;\n\nreturn {\n  json: {\n    analysis: aiResponse,\n    formatted: formattedOutput,\n    timestamp: timestamp,\n    date: today,\n    sourceCount: resultCount\n  }\n};"
      },
      "id": "format-output",
      "name": "Format Output",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1780,
        380
      ],
      "notesInFlow": true,
      "notes": "Ausgabe schÃ¶n formatieren"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "final",
              "name": "finalAnalysis",
              "type": "string",
              "value": "={{ $json.formatted }}"
            },
            {
              "id": "raw",
              "name": "rawAnalysis",
              "type": "string",
              "value": "={{ $json.analysis }}"
            }
          ]
        },
        "options": {}
      },
      "id": "output-node",
      "name": "Output",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2000,
        380
      ],
      "notesInFlow": true,
      "notes": "Hier kannst du Telegram, Email, oder File-Save anhÃ¤ngen"
    }
  ],
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Set Date & Searches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Date & Searches": {
      "main": [
        [
          {
            "node": "Split Searches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Searches": {
      "main": [
        [
          {
            "node": "Serper: Technical Analysis",
            "type": "main",
            "index": 0
          },
          {
            "node": "Serper: News & Forecasts",
            "type": "main",
            "index": 0
          },
          {
            "node": "Serper: Support/Resistance",
            "type": "main",
            "index": 0
          },
          {
            "node": "Serper: USD Impact",
            "type": "main",
            "index": 0
          },
          {
            "node": "Serper: Trader Sentiment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Serper: Technical Analysis": {
      "main": [
        [
          {
            "node": "Aggregate All Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Serper: News & Forecasts": {
      "main": [
        [
          {
            "node": "Aggregate All Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Serper: Support/Resistance": {
      "main": [
        [
          {
            "node": "Aggregate All Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Serper: USD Impact": {
      "main": [
        [
          {
            "node": "Aggregate All Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Serper: Trader Sentiment": {
      "main": [
        [
          {
            "node": "Aggregate All Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate All Results": {
      "main": [
        [
          {
            "node": "Prepare AI Prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare AI Prompt": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Format Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "xAI Grok Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Format Output": {
      "main": [
        [
          {
            "node": "Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2024-12-15T10:00:00.000Z",
      "updatedAt": "2024-12-15T10:00:00.000Z",
      "id": "1",
      "name": "Trading"
    },
    {
      "createdAt": "2024-12-15T10:00:00.000Z",
      "updatedAt": "2024-12-15T10:00:00.000Z",
      "id": "2",
      "name": "Gold"
    },
    {
      "createdAt": "2024-12-15T10:00:00.000Z",
      "updatedAt": "2024-12-15T10:00:00.000Z",
      "id": "3",
      "name": "XAUUSD"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2024-12-15T10:00:00.000Z",
  "versionId": "1"
}
